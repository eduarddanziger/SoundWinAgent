<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <!-- Go cgo package generation injected solution-wide to avoid editing .vcxproj -->
  <Target Name="GenerateGoPackage" AfterTargets="Build" Condition="'$(MSBuildProjectName)'=='SoundAgentApiDll'">
    <PropertyGroup>
      <DirSuffix Condition="'$(Configuration)'=='Debug'">-debug</DirSuffix>
      <GoPackageDir>$(SolutionDir)go\soundagent$(DirSuffix)\</GoPackageDir>
      <GoLibName>SoundAgentApiDll</GoLibName>
      <BuiltDll>$(TargetPath)</BuiltDll>
      <ImportLib>$(OutDir)$(TargetName).lib</ImportLib>
    </PropertyGroup>
    <MakeDir Directories="$(GoPackageDir)" Condition="!Exists('$(GoPackageDir)')" />
    <Copy SourceFiles="$(ProjectDir)SoundAgentApi.h" DestinationFolder="$(GoPackageDir)" SkipUnchangedFiles="true" />
    <Copy SourceFiles="$(BuiltDll)" DestinationFolder="$(GoPackageDir)" SkipUnchangedFiles="true" Condition="Exists('$(BuiltDll)')" />
    <Copy SourceFiles="$(ImportLib)" DestinationFolder="$(GoPackageDir)" SkipUnchangedFiles="true" Condition="Exists('$(ImportLib)')" />
    <!-- Generate cgo binding stub -->
    <WriteLinesToFile File="$(GoPackageDir)soundagent.go" Overwrite="true" Lines="// Code generated by build. DO NOT EDIT." />
    <WriteLinesToFile File="$(GoPackageDir)soundagent.go" Overwrite="false" Lines="package soundagent" />
    <WriteLinesToFile File="$(GoPackageDir)soundagent.go" Overwrite="false" Lines="" />
    <WriteLinesToFile File="$(GoPackageDir)soundagent.go" Overwrite="false" Lines="/*" />
    <WriteLinesToFile File="$(GoPackageDir)soundagent.go" Overwrite="false" Lines="#cgo CFLAGS: -I${SRCDIR}" />
    <WriteLinesToFile File="$(GoPackageDir)soundagent.go" Overwrite="false" Lines="#cgo LDFLAGS: -L${SRCDIR} -l$(GoLibName)" />
    <WriteLinesToFile File="$(GoPackageDir)soundagent.go" Overwrite="false" Lines="#include &quot;SoundAgentApi.h&quot;" />
    <WriteLinesToFile File="$(GoPackageDir)soundagent.go" Overwrite="false" Lines="*/" />
    <WriteLinesToFile File="$(GoPackageDir)soundagent.go" Overwrite="false" Lines="import &quot;C&quot;" />
    <Message Importance="High" Text="[SoundAgentApiDll] Generated Go cgo package at $(GoPackageDir)" />
  </Target>
</Project>
